# ä¿¡æ¯é‡‡é›†ç³»ç»Ÿ

**crawler-system-flask**  
ç‰ˆæœ¬å·ï¼šv2.0.0
90%çš„ä»£ç ä¿ç•™äº†ï¼Œåˆ é™¤äº†éƒ¨åˆ†æ¶‰å¯†ä¿¡æ¯ï¼Œæ ¸å¿ƒä»£ç éƒ½åœ¨ï¼Œå¤§æ¦‚ç‡å¯ä»¥è·‘èµ·æ¥ï¼Œåç»­æœ‰æ—¶é—´å†å®Œå–„

## ğŸ“Œ é¡¹ç›®ç®€ä»‹

ä¿¡æ¯é‡‡é›†ç³»ç»Ÿåç«¯æ˜¯åŸºäº Flask æ¡†æ¶æ„å»ºçš„æœåŠ¡ï¼Œæä¾›æ•°æ®é‡‡é›†ã€é‚®ä»¶æ¨é€ã€ç”¨æˆ·ç®¡ç†åŠŸèƒ½ã€‚
æœ¬æ„æ˜¯ç”¨äºç»¼åˆç®¡ç†ä¸€äº›å­¦æ ¡å…¬å‘Šé‡‡é›†çˆ¬è™«çš„å¹³å°ï¼Œçˆ¬è™«æ–‡ä»¶å·²ç§»é™¤ï¼Œå¯ä»¥æŒ‰éœ€å†™åœ¨caiji/modulesé‡Œ

## ğŸ“¦ ä½¿ç”¨è¯´æ˜

### 1. å…‹éš†é¡¹ç›®
```bash
git clone https://gitea.mgcsat.com/MgSziit/infosystem-flask.git
```

### 2. å®‰è£…ä¾èµ–
```bash
pip install -r requirements.txt
```
> ç”±äºrequirementsåŸå› ï¼Œéƒ¨åˆ†æƒ…å†µä¸‹å¯èƒ½éœ€è¦å•ç‹¬è¿è¡Œ
```bash
pip install flask_sqlalchemy
```
> æ¨èä½¿ç”¨è™šæ‹Ÿç¯å¢ƒï¼Œç¡®ä¿ Python ç‰ˆæœ¬ >= 3.9

### 3. æ•°æ®åº“åˆå§‹åŒ–
```bash
# å¯¼å…¥æ•°æ®åº“ç»“æ„
psql -d jdbc -h localhost -p 5432 -U postgres -f crawler_system_db.sql
```

### 4. é…ç½®æ–‡ä»¶è®¾ç½®
```bash
# å¤åˆ¶é…ç½®æ–‡ä»¶æ¨¡æ¿
cp config/config.ini.backup config/config.ini
# ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼Œå¡«å†™æ•°æ®åº“è¿æ¥ä¿¡æ¯ã€é‚®ä»¶æœåŠ¡å™¨ç­‰é…ç½®
```

### 5. å¯åŠ¨æœåŠ¡

#### Web API æœåŠ¡
```bash
python runweb.py
```
é»˜è®¤è®¿é—®åœ°å€ï¼šhttp://localhost:5000

#### æ•°æ®é‡‡é›†æœåŠ¡
```bash
python runcaiji.py
```

#### é‚®ä»¶æ¨é€æœåŠ¡
```bash
python runmail.py
```

## ğŸ—‚ é¡¹ç›®ç»“æ„è¯´æ˜

```
crawler-system-flask/
â”œâ”€ crawler_system_db.sql       # æ•°æ®åº“æ–‡ä»¶
â”œâ”€ README.md                   # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€ requirements.txt            # Python ä¾èµ–åˆ—è¡¨
â”œâ”€ runcaiji.py                # æ•°æ®é‡‡é›†æœåŠ¡å¯åŠ¨å…¥å£
â”œâ”€ runmail.py                 # é‚®ä»¶æ¨é€æœåŠ¡å¯åŠ¨å…¥å£
â”œâ”€ runweb.py                  # Web API æœåŠ¡å¯åŠ¨å…¥å£
â”œâ”€ www                        # å‰ç«¯é™æ€èµ„æºç›®å½•
â”œâ”€ mailpush                   # é‚®ä»¶æ¨é€æ¨¡å—
â”‚  â””â”€ mail                    # é‚®ä»¶åŠŸèƒ½å®ç°
â”‚     â”œâ”€ content_builder.py   # é‚®ä»¶å†…å®¹æ„å»ºå™¨
â”‚     â”œâ”€ email_count.py       # é‚®ä»¶è®¡æ•°åŠŸèƒ½
â”‚     â”œâ”€ email_heartbeat.py   # é‚®ä»¶å¿ƒè·³ç›‘æ§
â”‚     â”œâ”€ info_query.py        # ä¿¡æ¯æŸ¥è¯¢åŠŸèƒ½
â”‚     â”œâ”€ smtp_client.py       # SMTP å®¢æˆ·ç«¯å®ç°
â”‚     â””â”€ update_status.py     # çŠ¶æ€æ›´æ–°åŠŸèƒ½
â”œâ”€ logs                       # æ—¥å¿—æ¨¡å—
â”‚  â”œâ”€ logger_config.py        # æ—¥å¿—é…ç½®æ–‡ä»¶
â”‚  â””â”€ 2025_08                 # 2025å¹´8æœˆæ—¥å¿—ç›®å½•
â”œâ”€ config                     # é…ç½®æ–‡ä»¶ç›®å½•
â”‚  â”œâ”€ config.ini              # ä¸»é…ç½®æ–‡ä»¶
â”‚  â”œâ”€ config.ini.backup       # é…ç½®æ–‡ä»¶å¤‡ä»½
â”‚  â””â”€ db.py                   # æ•°æ®åº“è¿æ¥é…ç½®
â”œâ”€ caiji                      # æ•°æ®é‡‡é›†æ¨¡å—
â”‚  â”œâ”€ utils                   # é‡‡é›†å·¥å…·ç±»
â”‚  â”‚  â”œâ”€ common.py            # é€šç”¨å·¥å…·å‡½æ•°
â”‚  â”‚  â”œâ”€ config_loader.py     # é…ç½®åŠ è½½å™¨
â”‚  â”‚  â”œâ”€ DrissionPage.iml     # DrissionPage é…ç½®æ–‡ä»¶
â”‚  â”‚  â”œâ”€ operate_base.py      # åŸºç¡€æ“ä½œç±»
â”‚  â”‚  â”œâ”€ pool_synchronization.py # æ± åŒæ­¥å·¥å…·
â”‚  â”‚  â”œâ”€ read_base.py         # åŸºç¡€è¯»å–ç±»
â”‚  â”‚  â””â”€ send_heartbeat.py   # å¿ƒè·³å‘é€å·¥å…·
â”‚  â”œâ”€ modules                 # é‡‡é›†æ¨¡å—å®ç°
â”‚  â””â”€ main                    # é‡‡é›†ä¸»ç¨‹åº
â”‚     â”œâ”€ caiji_main.py        # é‡‡é›†ä¸»é€»è¾‘
â”‚     â”œâ”€ keyword_transmit.py  # å…³é”®è¯ä¼ é€’åŠŸèƒ½
â”‚     â”œâ”€ modules_logs.py      # æ¨¡å—æ—¥å¿—ç®¡ç†
â”‚     â””â”€ __pycache__          # Python å­—èŠ‚ç ç¼“å­˜ç›®å½•
â””â”€ app                        # Flask åº”ç”¨æ ¸å¿ƒæ¨¡å—
   â”œâ”€ __init__.py             # Flask åº”ç”¨åˆå§‹åŒ–
   â”œâ”€ __pycache__             # Python å­—èŠ‚ç ç¼“å­˜ç›®å½•
   â”œâ”€ utils                   # åº”ç”¨å·¥å…·ç±»
   â”‚  â”œâ”€ recover_caiji.py     # é‡‡é›†æ¢å¤å·¥å…·
   â”‚  â”œâ”€ recover_mail.py      # é‚®ä»¶æ¢å¤å·¥å…·
   â”‚  â””â”€ __pycache__          # Python å­—èŠ‚ç ç¼“å­˜ç›®å½•
   â”œâ”€ routes                  # API è·¯ç”±æ¨¡å—
   â”‚  â”œâ”€ auth.py              # è®¤è¯ç›¸å…³è·¯ç”±
   â”‚  â”œâ”€ configuration_api.py # é…ç½®ç®¡ç†æ¥å£
   â”‚  â”œâ”€ crawler_api.py       # çˆ¬è™«æ§åˆ¶æ¥å£
   â”‚  â”œâ”€ heartbeat_api.py     # å¿ƒè·³ç›‘æ§æ¥å£
   â”‚  â”œâ”€ result_api.py        # ç»“æœæŸ¥è¯¢æ¥å£
   â”‚  â”œâ”€ users_api.py         # ç”¨æˆ·ç®¡ç†æ¥å£
   â”‚  â”œâ”€ __init__.py          # è·¯ç”±æ¨¡å—åˆå§‹åŒ–
   â”‚  â””â”€ __pycache__          # Python å­—èŠ‚ç ç¼“å­˜ç›®å½•
   â””â”€ models                  # æ•°æ®æ¨¡å‹
      â”œâ”€ base_crawler.py      # çˆ¬è™«åŸºç±»
      â”œâ”€ crawler_config.py    # çˆ¬è™«é…ç½®æ¨¡å‹
      â”œâ”€ crawl_pool.py        # çˆ¬è™«æ± ç®¡ç†
      â”œâ”€ crawl_results.py     # é‡‡é›†ç»“æœæ¨¡å‹
      â”œâ”€ heartbeat_model.py   # å¿ƒè·³ç›‘æ§æ¨¡å‹
      â”œâ”€ users_model.py       # ç”¨æˆ·æ¨¡å‹
      â”œâ”€ __init__.py          # æ¨¡å‹æ¨¡å—åˆå§‹åŒ–
      â””â”€ __pycache__          # Python å­—èŠ‚ç ç¼“å­˜ç›®å½•
```

## ğŸ“¡ API æ¥å£è¯´æ˜

ä¸»è¦æ¥å£åŒ…æ‹¬ï¼š
- `/api/config/*` - é…ç½®ç®¡ç†ç›¸å…³æ¥å£
- `/api/crawler/*` - çˆ¬è™«æ§åˆ¶ç›¸å…³æ¥å£
- `/api/heartbeat/*` - å¿ƒè·³ç›‘æ§ç›¸å…³æ¥å£
- `/api/results/*` - ç»“æœæŸ¥è¯¢ç›¸å…³æ¥å£
- `/api/users/*` - ç”¨æˆ·ç®¡ç†ç›¸å…³æ¥å£
- `/api/login/*` - ç™»å½•ç›¸å…³æ¥å£

## ğŸ“„ ç‰ˆæœ¬è®°å½•

- **v2.0.0**ï¼ˆå½“å‰ç‰ˆæœ¬ï¼‰ï¼šæ¶æ„ä¼˜åŒ–ï¼Œå®ç°Linuxç§»æ¤
- **v1.0.0**ï¼ˆ2025-05-08ï¼‰ï¼šåˆå§‹ç‰ˆæœ¬ï¼ŒåŸºç¡€é‡‡é›†åŠŸèƒ½å®ç°